# 第二题参考脚本

```
#题目要求
有日志1.log，部分内容如下：
112.111.12.248 - - [04/Nov/2018:22:00:25 +0800] "GET / HTTP/1.1" 200 7 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36"
61.147.76.52 - - [04/Nov/2018:22:00:25 +0800] "GET /favicon.ico HTTP/1.1" 404 571 "https://aming.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36"

统计出每个IP的访问量有多少

#题目分析
这种分析日志的需求，在平时工作中很常见，而且找运维工作时的笔记题里面出现频率也非常多。根据日志内容，可以看到IP地址就是第一段内容，所以只需要把1.log的第一段给过滤出来，然后进一步统计每个IP的量即可。

#参考答案
#!/bin/bash
#作者：小杨
#日期：2018/12/2
#版本：v0.1

awk '{print $1}' 1.log | sort -n |uniq -c |sort -n

#答案解析
1、awk命令在分段方面还是比较有优势的，这里的{print $1}将第一段打印出来，awk可以用-F指定分隔符，如果不指定分隔符，默认就以空白字符（比如空格、Tab等），本题中，IP地址就是在第一段
2、sort命令是排序的命令，-n选项表示以数字的形式排序，如果不加-n，则以ASCII排序，本题中IP地址以数字的形式排序更容易区分
3、uniq命令是用来去重复的，一个文本中如果有多行内容是一模一样的，使用uniq命令就可以把相同内容的行删除掉，只留一行，而-c选项的作用是计算重复的行数，所以在此题中使用uniq -c正好可以计算IP地址的访问数量。不过，大家一定要注意，uniq云重的前提是首先要排序
4、本题答案里的最后的sort -n意思是按访问量大小来排序，请求量越大的IP排在越后面，如果想排在前面，可以加一个-r选项，即sort -nr